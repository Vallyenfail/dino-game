"""
Задание 3.6: Система уровней (увеличение сложности)

ПРОБЛЕМА:
Игра идёт с одинаковой скоростью от начала до конца. Нет прогрессии сложности.

РЕШЕНИЕ:
Добавить систему уровней, которая увеличивает скорость препятствий при достижении
определённого количества очков.

================================================================================
ШАГ 1: ДОБАВЛЕНИЕ ПЕРЕМЕННОЙ УРОВНЯ
================================================================================

В game.py, в методе __init__() (строка ~12), добавьте:

    self.level = 1  # Текущий уровень сложности


================================================================================
ШАГ 2: ДОБАВЛЕНИЕ ЛОГИКИ УВЕЛИЧЕНИЯ УРОВНЯ
================================================================================

В game.py, в методе run_game(), после count_score() (примерно строка 212):
"""

# ДОБАВЬТЕ ЭТОТ КОД после self.count_score(cactus_arr):

# Система уровней
if self.scores >= 50 and self.level == 1:
    self.level = 2
    # Увеличиваем скорость всех кактусов
    for cactus in cactus_arr:
        cactus.speed = 6  # Было 4
    # Можно добавить звуковой сигнал
    # pygame.mixer.Sound.play(pickup_sound)

if self.scores >= 100 and self.level == 2:
    self.level = 3
    for cactus in cactus_arr:
        cactus.speed = 8  # Ещё быстрее

if self.scores >= 200 and self.level == 3:
    self.level = 4
    for cactus in cactus_arr:
        cactus.speed = 10  # Максимальная сложность


"""
================================================================================
ШАГ 3 (ОПЦИОНАЛЬНО): ОТОБРАЖЕНИЕ УРОВНЯ НА ЭКРАНЕ
================================================================================

В run_game(), после отображения счёта (строка ~172):
"""

# После: print_text('Score: ' + str(self.scores), 600, 10)
# Добавьте:
print_text('Level: ' + str(self.level), 20, 10, font_size=30)


"""
================================================================================
РАСШИРЕННАЯ ВЕРСИЯ: Больше изменений на каждом уровне
================================================================================
"""

def level_system_extended(self):
    """Расширенная система уровней с большими изменениями"""
    
    # В run_game() добавьте:
    
    # Уровень 2: Увеличение скорости + скорость птиц
    if self.scores >= 50 and self.level == 1:
        self.level = 2
        # Кактусы быстрее
        for cactus in cactus_arr:
            cactus.speed = 6
        # Птицы быстрее
        for bird in all_birds:
            bird.speed = 4  # Было 3
        print_text('LEVEL 2!', 330, 250, font_size=60, font_color=(255, 215, 0))
        pygame.display.update()
        pygame.time.delay(1000)
    
    # Уровень 3: Ещё быстрее + чаще появляются враги
    if self.scores >= 100 and self.level == 2:
        self.level = 3
        for cactus in cactus_arr:
            cactus.speed = 8
        for bird in all_birds:
            bird.speed = 5
        # Можно добавить третью птицу
        # bird3 = Bird(-60)
        # all_birds.append(bird3)
        print_text('LEVEL 3!', 330, 250, font_size=60, font_color=(255, 100, 0))
        pygame.display.update()
        pygame.time.delay(1000)
    
    # Уровень 4: Максимальная сложность
    if self.scores >= 200 and self.level == 3:
        self.level = 4
        for cactus in cactus_arr:
            cactus.speed = 10
        for bird in all_birds:
            bird.speed = 6
        print_text('FINAL LEVEL!', 280, 250, font_size=60, font_color=(255, 0, 0))
        pygame.display.update()
        pygame.time.delay(1000)


"""
================================================================================
ВАРИАНТ С ГРАДУАЛЬНЫМ УВЕЛИЧЕНИЕМ
================================================================================

Вместо резких скачков можно плавно увеличивать скорость:
"""

def level_system_gradual(self):
    """Плавное увеличение сложности"""
    
    # В run_game() добавьте:
    
    # Увеличиваем скорость каждые 25 очков
    if self.scores > 0 and self.scores % 25 == 0:
        if not hasattr(self, 'last_speed_increase'):
            self.last_speed_increase = 0
        
        if self.scores > self.last_speed_increase:
            # Увеличиваем скорость на 0.5
            for cactus in cactus_arr:
                cactus.speed += 0.5
            
            self.last_speed_increase = self.scores
            self.level = self.scores // 25 + 1


"""
================================================================================
СБРОС УРОВНЯ ПРИ ПЕРЕЗАПУСКЕ
================================================================================

В start_game() (строка ~78), добавьте сброс уровня:
"""

# В методе start_game():
def start_game(self):
    while self.run_game():
        self.scores = 0
        self.make_jump = False
        self.jump_counter = 30
        p.usr_y = p.display_height - p.usr_height - 100
        self.health = 2
        self.cooldown = 0
        self.level = 1  # ДОБАВЛЕНО: сброс уровня


"""
================================================================================
ПОЛНЫЙ КОД ДЛЯ КОПИРОВАНИЯ
================================================================================
"""

# 1. В __init__() добавить:
"""
self.level = 1
"""

# 2. В run_game() после count_score():
"""
# Система уровней
if self.scores >= 50 and self.level == 1:
    self.level = 2
    for cactus in cactus_arr:
        cactus.speed = 6

if self.scores >= 100 and self.level == 2:
    self.level = 3
    for cactus in cactus_arr:
        cactus.speed = 8

if self.scores >= 200 and self.level == 3:
    self.level = 4
    for cactus in cactus_arr:
        cactus.speed = 10
"""

# 3. Отображение уровня (опционально):
"""
print_text('Level: ' + str(self.level), 20, 10, font_size=30)
"""

# 4. В start_game() добавить сброс:
"""
self.level = 1
"""


"""
================================================================================
ОЖИДАЕМЫЙ РЕЗУЛЬТАТ
================================================================================

✅ Игра начинается на уровне 1 с обычной скоростью
✅ При 50 очках переход на уровень 2 - кактусы ускоряются
✅ При 100 очках уровень 3 - ещё быстрее
✅ При 200 очках уровень 4 - максимальная сложность
✅ Уровень отображается на экране
✅ После Game Over уровень сбрасывается

КАК ПРОВЕРИТЬ:
1. Запустите игру
2. Наберите 50 очков - кактусы должны ускориться
3. Наберите 100 очков - ещё ускорение
4. Проверьте что после Game Over всё сбрасывается

СОВЕТЫ ПО БАЛАНСУ:
- Пороги: 50, 100, 200 можно изменить
- Скорости: 6, 8, 10 можно уменьшить если слишком сложно
- Добавьте больше уровней или меньше - как вам нравится
"""
